The feature server function is split between different host. (And this is work in progress.)

The FreeSwitch configuration should be static; the parameters are all handled by CouchDb using the proxy application I describe in http://blog.shimaore.net/2009/01/freeswitch-modxmlcurl-yaws-erlang-and.html

The layout is as follows:
- The FreeSwitch host handles the calls and, via xml_curl, gathers all the dialplan information from dialplan.yaws.
- Yaws and CouchDb run on the same server; dialplan.yaws proxies the FreeSwitch query and turns it into a CouchDb query.
- The host running Yaws needs to have ecouch http://code.google.com/p/ecouch/ (e.g. in /usr/lib/erlang/lib ) as it is used by dialplan.yaws. Ecouch is started from within Yaws using a module called mod_ecouch.
- CouchDb hosts a database called "dialplan" which must at least contain the view "freeswitch/xml" described in couchdb_dialplan_freeswitch_xml.js

In these configuration files I assume the host running Yaws + CouchDb is called db1.${__DOMAIN__}. The goal eventually is to use CouchDb replication to have db1, db2, etc. since FreeSwitch supports multiple targets for xml_curl.

-------
How to make followme.pl work

Don't forget to install libcrypt-ssleay-perl if you're using SSL for cross-server encryption.

-------

How to install ecouch: (you'll need subversion installed)


cd /usr/lib/erlang/lib
svn checkout http://ecouch.googlecode.com/svn/trunk/ ecouch-svn
cd ecouch-svn
make

-------

How to install mod_ecouch

cd /usr/lib/yaws/ebin
# copy mod_ecouch.erl
erlc mod_ecouch.erl
# rm mod_ecouch.erl

-------

How to install rfc4627

aptitude install erlang-base-hipe erlang-nox erlang-dev erlang-src
wget http://hg.opensource.lshift.net/erlang-rfc4627/archive/tip.tar.bz2
tar tjvf tip.tar.bz2
cd erlang-rfc4627-*/
dpkg-buildpackage

Then install the resulting .deb.

-------

FreeSwitch installation

sudo aptitude install libasound2 libcurl3 libvorbis0a
sudo dpkg -i freeswitch_1.0.3-1_i386.deb 
sudo dpkg -i freeswitch-codec-passthru-g729_1.0.3-1_i386.deb 
sudo dpkg -i freeswitch-perl_1.0.3-1_i386.deb 
sudo dpkg -i freeswitch-lua_1.0.3-1_i386.deb 
sudo dpkg -i freeswitch-sounds-en-us-callie-8000_1.0.3-1_i386.deb 
sudo dpkg -i freeswitch-sounds-music-8000_1.0.3-1_i386.deb 
sudo dpkg -i freeswitch-spidermonkey_1.0.3-1_i386.deb 
sudo dpkg -i /home/adminuser/freeswitch-lang-en_1.0.3-1_i386.deb 

Don't forget to enable mod_xml_curl >:)

--------

About connect-to-caller-press-1.wav

This file was generated from the sound files found in FreeSwitch. It is made available under the same terms as the original sound files.